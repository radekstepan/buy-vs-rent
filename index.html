<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Buy vs Rent</title>
    <style>
    body {
      padding: 20px;
    }
    #chart {
      width: 60%;
      height: 500px;
      border: 1px solid #ddd;
      border-radius: 3px;
      margin: 0 auto;
    }
    </style>
    <script src="data.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>
    <script src="http://unpkg.com/frappe-charts@0.0.3/dist/frappe-charts.min.iife.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cash/1.3.5/cash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
    <script>
      $(function() {
        const { data, props } = d;

        const n = 20;
        const max = Math.max(d3.extent(data.rent)[1], d3.extent(data.buy)[1]);

        const x = d3.scaleLinear().domain([0, max]).nice(n);
        const histogram = d3.histogram().domain(x.domain()).thresholds(x.ticks(n));
        const bins ={
          rent: histogram(data.rent),
          buy: histogram(data.buy),
          couch: histogram(data.couch)
        };

        new Chart({
          parent: "#chart",
          title: [
            'INCOME:',
            numeral(props.income).format('$0.0a'),
            'HOUSE:',
            numeral(props.house).format('$0.0a'),
            'RENT:',
            numeral(props.rent).format('$0.0a'),
          ].join(' '),
          data: {
            labels: bins.rent.map(bin => numeral(bin.x1).format('0.0a')),
            datasets: [
              {
                color: "green",
                title: "Rent",
                values: bins.rent.map(bin => bin.length)
              }, {
                color: "blue",
                title: "Buy",
                values: bins.buy.map(bin => bin.length)
              }
              // }, {
              //   color: "grey",
              //   title: "Couch",
              //   values: bins.couch.map(bin => bin.length)
              // }
            ]
          },
          type: 'line',
          heatline: 1,
          height: 500
        });
      });
    </script>
  </head>
  <body>
    <div id="chart"></div>
  </body>
</html>
